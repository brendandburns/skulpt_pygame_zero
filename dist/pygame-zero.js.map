{"version":3,"sources":["utils.js","pygame-zero.js"],"names":["loadScript","src","varName","window","Promise","resolve","reject","el","document","createElement","onload","onerror","e","body","removeChild","async","console","log","appendChild","hitTestRectangle","r1","r2","Array","isArray","x","y","width","height","centerX","centerY","halfWidth","halfHeight","vx","vy","combinedHalfWidths","combinedHalfHeights","hit","Math","abs","JsonLoadedMap","textureRecources","resource","loadResource","list","PIXI","utils","TextureCache","loader","add","load","texture","resources","test","fetch","then","res","json","prefix","replace","resoureList","map","item","Sk","defineGetter","func","misceval","callsimOrSuspend","builtins","property","builtin","genkwaFunc","isJsArgs","kwaFunc","kwa","args","kwargs","dict","defineProperty","obj","self","ffi","remapToPy","val","v","ColorNameMap","aqua","black","blue","fuchsia","gray","green","lime","maroon","navy","olive","orange","purple","red","silver","teal","white","yellow","$builtinmodule","mod","__name__","str","isWebGLSupported","Application","Sprite","Graphics","Text","TextStyle","pre","next","crossOrigin","loadType","loaders","Resource","LOAD_TYPE","XHR","PGZApp","destroy","removeView","backgroundColor","app","round","view","transX","isReserve","transY","transPos","pos","transColor","color","rgb2hex","match","string2hex","PyGameZero","container","WIDTH","HEIGHT","Actor","buildClass","$gbl","$loc","__init__","actorName","promiseToSuspension","remapToJs","sprite","zOrder","anchor","set","angle","show","image","frame","distance_to","sqrt","pow","angle_to","x1","x2","y1","y2","z","asin","PI","collide_point","collide_actor","actor","colliderect","remove","stage","draw","addChild","Rect","size","graph","line","start","end","lineStyle","moveTo","lineTo","circle","radius","drawCircle","filled_circle","beginFill","endFill","rect","abstr","typeName","drawRect","left","top","leftTop","shift","filled_rect","clear","basicText","text","fontsize","fontname","style","fontFamily","fontSize","fill","screen","children","length","child","getChildAt","clock","timerMap","WeakMap","schedule","callback","delay","setTimeout","callsimAsync","schedule_interval","setInterval","schedule_unique","has","clearTimeout","get","clearInterval","unschedule","music","audio","Audio","play","name","loop","play_once","s","is_playing","paused","volume","set_volume","get_volume","stop","currentTime","pause","sound","soundMap","animate","tween","duration","on_finished","targets","ticker","TWEEN","update","tweenMap","linear","Easing","accelerate","Quartic","Out","decelerate","In","accel_decel","InOut","elastic_start","Elastic","elastic_end","elastic_start_end","bounce_start","Bounce","bounce_end","bounce_start_end","ani","Tween","to","easing","onUpdate","object","onComplete","callsim","running","tweens","playing","delta","globals","keys","keysMap","nativeKeys","index","keyboard","addEventListener","key","on_key_down","Keys","i","toLowerCase","mouseDownMap","mousePos","buttons","insertData","arr","data","indexOf","push","delData","splice","button","on_mouse_down","offsetX","offsetY","on_mouse_up","oncontextmenu","on_mouse_move","deltaY","mouse","LEFT","MIDDLE","RIGHT","WHEEL_UP","WHEEL_DOWN","go"],"mappings":"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","file":"pygame-zero.js","sourceRoot":"../src","sourcesContent":["export function loadScript(src, varName){\n  if (window[varName]) {\n    return Promise.resolve(window[varName]);\n  }\n  const res = new Promise(function(resolve, reject) {\n    const el = document.createElement('script');\n    el.onload = function() {\n      resolve(varName && window.varName);\n    };\n\n    el.onerror = function(e) {\n      el.onload = null;\n      el.onerror = null;\n      document.body.removeChild(el);\n      reject(e);\n    };\n    el.src = src;\n    el.async = true;\n    console.log(document.body)\n    document.body.appendChild(el);\n  });\n  return res;\n}\n\n\n// 碰撞检测函数\nexport function hitTestRectangle(r1, r2) {\n  // 如果r2是坐标点\n  if (Array.isArray(r2)) {\n    r2.x = r2[0];\n    r2.y = r2[1];\n    r2.width = 0;\n    r2.height = 0;\n  }\n\n  //Define the variables we'll need to calculate\n  let hit;\n\n  //hit will determine whether there's a collision\n  hit = false;\n\n  //Find the center points of each sprite\n  r1.centerX = r1.x + r1.width / 2;\n  r1.centerY = r1.y + r1.height / 2;\n  r2.centerX = r2.x + r2.width / 2;\n  r2.centerY = r2.y + r2.height / 2;\n\n  //Find the half-widths and half-heights of each sprite\n  r1.halfWidth = r1.width / 2;\n  r1.halfHeight = r1.height / 2;\n  r2.halfWidth = r2.width / 2;\n  r2.halfHeight = r2.height / 2;\n\n  //Calculate the distance vector between the sprites\n  const vx = r1.centerX - r2.centerX;\n  const vy = r1.centerY - r2.centerY;\n\n  //Figure out the combined half-widths and half-heights\n  const combinedHalfWidths = r1.halfWidth + r2.halfWidth;\n  const combinedHalfHeights = r1.halfHeight + r2.halfHeight;\n\n  //Check for a collision on the x axis\n  if (Math.abs(vx) < combinedHalfWidths) {\n\n    //A collision might be occuring. Check for a collision on the y axis\n    if (Math.abs(vy) < combinedHalfHeights) {\n\n      //There's definitely a collision happening\n      hit = true;\n    } else {\n\n      //There's no collision on the y axis\n      hit = false;\n    }\n  } else {\n\n    //There's no collision on the x axis\n    hit = false;\n  }\n\n  //`hit` will be either `true` or `false`\n  return hit;\n}\n\n// 加载纹理\nconst JsonLoadedMap = {};\nexport function textureRecources (resource) {\n  function loadResource(resource) {\n    let list;\n    if (Array.isArray(resource)) {\n      list = [...resource];\n      resource = list[0]\n    }\n    return new Promise((resolve, reject) => {\n      if (window.PIXI.utils.TextureCache[resource]) {\n        resolve(window.PIXI.utils.TextureCache[resource])\n      } else {\n        console.log(list || resource)\n        window.PIXI.loader.add(list || resource).load(function() {\n          const texture = window.PIXI.loader.resources[resource].texture;\n          resolve(texture)\n        });\n      }\n    })\n  }\n  if (/\\.json$/.test(resource)) {\n    if (JsonLoadedMap[resource]) {\n      return loadResource(JsonLoadedMap[resource])\n    } else {\n      return fetch(resource).then((res) => {\n        return res.json()\n      }).then((res) => {\n        const prefix = resource.replace('index.json', '');\n        const resoureList = res.map((item) => {\n          return prefix + item\n        })\n        JsonLoadedMap[resource] = resoureList;\n        return loadResource(resoureList)\n      })\n    }\n  } else {\n    return loadResource(resource)\n  }\n}\nconst Sk = window.Sk;\n// getter函数\nexport const defineGetter = function(func) {\n  return Sk.misceval.callsimOrSuspend(Sk.builtins.property, new Sk.builtin.func(func), new Sk.builtin.func(function() {}));\n}\n// 生成kwargs函数\nexport function genkwaFunc(func, isJsArgs) {\n  const kwaFunc = function(kwa, ...args){\n    if (!isJsArgs) {\n      args = new Sk.builtins['tuple'](args); /*vararg*/\n    }\n    const kwargs = new Sk.builtin.dict(kwa);\n    return func(args, kwargs)\n  }\n  kwaFunc['co_kwargs'] = true;\n  return kwaFunc;\n}\n// 监听属性getter/setter\nexport const defineProperty = function(obj, property) {\n  return Sk.misceval.callsimOrSuspend(Sk.builtins.property, new Sk.builtin.func(function(self) {\n    if (typeof obj === 'function') {\n      return obj(self)\n    } else {\n      return Sk.ffi.remapToPy(self[obj][property])\n    }\n  }), new Sk.builtin.func(function(self, val) {\n    if (typeof property === 'function') {\n      property(self, val)\n    } else {\n      self[obj][property] = val.v;\n    }\n  }))\n}\n  \n\n","const Sk = window.Sk;\nconst PIXI = window.PIXI;\nimport {loadScript, textureRecources, defineGetter, defineProperty, hitTestRectangle, genkwaFunc} from './utils'\n// 17中标准颜色名对应的色值\nconst ColorNameMap = {\n  aqua: '#00FFFF',\n  black: '#000000',\n  blue: '#0000FF',\n  fuchsia: '#FF00FF',\n  gray: '#808080',\n  green: '#008000',\n  lime: '#00FF00',\n  maroon: '#800000',\n  navy: '#000080',\n  olive: '#808000',\n  orange: '#FFA500',\n  purple: '#800080',\n  red: '#FF0000',\n  silver: '#C0C0C0',\n  teal: '#008080',\n  white: '#FFFFFF',\n  yellow: '#FFFF00',\n}\n\nwindow.$builtinmodule = function() {\n  const mod = { __name__: new Sk.builtin.str(\"pygame-zero\") };\n  let type = \"WebGL\"\n  if(!PIXI.utils.isWebGLSupported()){\n    type = \"canvas\"\n  }\n\n  // PIXI.utils.sayHello(type)\n  //Aliases\n  const Application = PIXI.Application,\n    loader = PIXI.loader,\n    resources = PIXI.loader.resources,\n    utils = PIXI.utils,\n    Sprite = PIXI.Sprite,\n    Graphics = PIXI.Graphics,\n    Text = PIXI.Text,\n    TextStyle = PIXI.TextStyle;\n  window.PIXI.loader.pre((resource, next) => {\n    resource.crossOrigin = 'anonymous';\n    resource.loadType = window.PIXI.loaders.Resource.LOAD_TYPE.XHR;\n    next();\n  });\n  if (window.PGZApp) {\n    // document.getElementById('stage').removeChild(window.PGZApp.view);\n    window.PGZApp.destroy({\n      removeView: true\n    });\n    loader.destroy();\n    window.PGZApp = void 0;\n  }\n  window.PGZApp = new Application({\n    backgroundColor: 0x000000,\n    width: 500,\n    height: 400,\n  });\n  const app = window.PGZApp;\n \n  const halfWidth = Math.round(app.view.width/2);\n  const halfHeight = Math.round(app.view.height/2);\n  // 笛卡尔坐标系转换\n  function transX(x, isReserve) {\n    // if (isReserve) {\n    //   return x - halfWidth\n    // } else {\n    //   return x + halfWidth\n    // }\n    return x;\n  }\n  // 笛卡尔坐标系转换\n  function transY(y, isReserve) {\n    // if (isReserve) {\n    //   if (y > halfHeight) {\n    //     return (y - halfHeight) * -1;\n    //   } else {\n    //     return halfHeight - y;\n    //   }\n    // } else {\n    //   if (y > 0) {\n    //     return halfHeight - y;\n    //   } else {\n    //     return halfHeight + (y * -1);\n    //   }\n    // }\n    return y;\n  }\n  function transPos(pos, isReserve){\n    if (!pos) {\n      return pos\n    }\n    return [transX(pos[0], isReserve), transY(pos[1], isReserve)]\n  }\n  // 字符串色值转十六进制数字\n  function transColor(color) {\n    if (Array.isArray(color)) {\n      return utils.rgb2hex(color);\n    } else {\n      if (color.match('#')) {\n        return utils.string2hex(color);\n      } else {\n        if (ColorNameMap[color]) {\n          return utils.string2hex(ColorNameMap[color]);\n        } else {\n          return 0xffffff;\n        }\n      }\n    }\n  }\n\n  window.PyGameZero.container.appendChild(app.view);\n  \n  mod.WIDTH = Sk.ffi.remapToPy(app.view.width);\n  mod.HEIGHT = Sk.ffi.remapToPy(app.view.height);\n\n  // 角色类\n  mod.Actor = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    // $loc.__init__就是构造器\n    $loc.__init__ = new Sk.builtin.func(function(self, actorName, pos) {\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        actorName = Sk.ffi.remapToJs(actorName);\n        pos = Sk.ffi.remapToJs(pos) || [];\n        textureRecources(actorName || `./assets/${actorName.v}/index.json`).then(function(texture) {\n          const sprite = new Sprite(texture)\n          sprite.zOrder=1\n          self.sprite = sprite;\n          self.sprite.anchor.set(0.5);\n          self.sprite.x = transX(pos[0] || 0)\n          self.sprite.y = transY(pos[1] || 0)\n          self.actorName = actorName;\n          resolve()\n        })\n      }));\n    });\n    $loc.x = defineProperty(function(self){\n      return Sk.ffi.remapToPy(transX(self.sprite.x, true))\n    }, function(self, val){\n      self.sprite.x = transX(val.v)\n    })\n    $loc.y = defineProperty(function(self){\n      return Sk.ffi.remapToPy(transY(self.sprite.y, true))\n    }, function(self, val){\n      self.sprite.y = transY(val.v)\n    })\n    $loc.width = defineProperty('sprite', 'width')\n    $loc.height = defineProperty('sprite', 'height')\n    $loc.pos = defineProperty(function(self) {\n      return Sk.ffi.remapToPy(transPos([self.sprite.x, self.sprite.y], true))\n    }, function (self, val) {\n      const pos = transPos(Sk.ffi.remapToJs(val))\n      self.sprite.x = pos[0];\n      self.sprite.y = pos[1];\n      self['sprite']['pos'] = [pos[0], pos[1]];\n    })\n    $loc.angle = defineProperty('sprite', 'angle')\n    $loc.show  = defineProperty('sprite', 'visible')\n    $loc.image = defineProperty(function(self) {\n      return Sk.ffi.remapToPy(self['sprite']['texture'])\n    }, function (self, val) {\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        textureRecources(val.v).then(function(texture) {\n          self['sprite']['texture'] = texture;\n          resolve()\n        })\n      }))\n    })\n    $loc.frame = defineProperty(function(self) {\n      return Sk.ffi.remapToPy(self['sprite']['texture'])\n      }, function (self, val) {\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        textureRecources(self.actorName[val.v-1] || `./assets/${self.actorName}/造型${val.v}.png`).then(function(texture) {\n          self['sprite']['texture'] = texture;\n          resolve()\n        })\n      }))\n    })\n    $loc.distance_to = new Sk.builtin.func(function(self, pos) {\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      // 计算两点距离：|AB| = √((x1-x2)²+(y1-y2)²)\n      return Sk.ffi.remapToPy(Math.round(Math.abs(Math.sqrt(Math.pow(self.sprite.x - pos[0], 2) + Math.pow(self.sprite.y - pos[1], 2)))))\n    })\n    $loc.angle_to = new Sk.builtin.func(function(self, pos) {\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      // 计算两点角度：arcsin(|y1-y2| ÷ √((x1-x2)²+(y1-y2)²)) ÷ π ×180\n      const x1 = self.sprite.y;\n      const x2 = pos[0];\n      const y1 = self.sprite.y;\n      const y2 = pos[1];\n      const x = Math.abs(x1-x2);\n      const y = Math.abs(y1-y2);\n      const z = Math.sqrt(x*x+y*y);\n      return Sk.ffi.remapToPy(Math.round(Math.asin(y/z)/Math.PI*180))\n    })\n    $loc.collide_point = new Sk.builtin.func(function(self, pos) {\n      return hitTestRectangle(self.sprite, transPos(Sk.ffi.remapToJs(pos)))\n    })\n    $loc.collide_actor = new Sk.builtin.func(function(self, actor) {\n      return hitTestRectangle(self.sprite, actor.sprite)\n    })\n    $loc.colliderect = new Sk.builtin.func(function(self, actor) {\n      return hitTestRectangle(self.sprite, actor.sprite)\n    })\n    $loc.remove = new Sk.builtin.func(function(self) {\n      app.stage.removeChild(self.sprite);\n    })\n    $loc.draw = new Sk.builtin.func(function(self) {\n      app.stage.addChild(self.sprite);\n    })\n  }, 'Actor')\n  // 矩形类\n  mod.Rect = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    // $loc.__init__就是构造器\n    let _self;\n    $loc.__init__ = new Sk.builtin.func(function(self, pos, size) {\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      size = Sk.ffi.remapToJs(size);\n      self.pos = {\n        x: pos[0],\n        y: pos[1],\n      }\n      self.size = {\n        width: size[0],\n        height: size[1],\n      }\n    });\n    $loc.pos = defineGetter((self) => Sk.ffi.remapToPy(transPos(self.pos, true)))\n    $loc.size = defineGetter((self) => Sk.ffi.remapToPy(self.size))\n  }, 'Rect', [])\n  // 画笔类\n  const graph = new Graphics();\n  mod.draw = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.size = 5;\n    })\n    $loc.size = new Sk.builtin.func(function(self, size) {\n      self.size = size.v;\n    })\n    // $loc.fill = new Sk.builtin.func(function(self, color) {\n    //   color = transColor(Sk.ffi.remapToJs(color));\n    //   graph.beginFill(color)\n    // })\n    $loc.line =  new Sk.builtin.func(function(self, start, end, color) {\n      color = transColor(Sk.ffi.remapToJs(color));\n      start = Sk.ffi.remapToJs(start);\n      end = Sk.ffi.remapToJs(end);\n      graph.lineStyle(self.size || 2, color, 1);\n      graph.moveTo(start[0], start[1]);\n      graph.lineTo(end[0], end[1]);\n      app.stage.addChild(graph);\n    })\n    $loc.circle =  new Sk.builtin.func(function(self, pos, radius, color) {\n      color = transColor(Sk.ffi.remapToJs(color));\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      graph.lineStyle(self.size, color, 1);\n      graph.drawCircle(pos[0], pos[1], radius.v);\n      app.stage.addChild(graph);\n    })\n    $loc.filled_circle =  new Sk.builtin.func(function(self, pos, radius, color) {\n      color = transColor(Sk.ffi.remapToJs(color));\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      graph.lineStyle(0);\n      graph.beginFill(color, 1);\n      graph.drawCircle(pos[0], pos[1], radius.v);\n      graph.endFill();\n      app.stage.addChild(graph);\n    })\n    $loc.rect =  new Sk.builtin.func(function(self, ...args) {\n      if (Sk.abstr.typeName(args[0]) === \"Rect\") {\n        const [rect, color] = args;\n        graph.lineStyle(self.size, transColor(Sk.ffi.remapToJs(color)), 1);\n        graph.drawRect(rect.pos.x, rect.pos.y, rect.size.width, rect.size.height);\n        app.stage.addChild(graph);\n      } else {\n        let left, top\n        const leftTop = Sk.ffi.remapToJs(args[0])\n        if (Array.isArray(leftTop)) {\n          left = leftTop[0]\n          top = leftTop[1]\n          args.shift();\n        } else {\n          left = args[0].v\n          top = args[1].v\n          args.shift();\n          args.shift();\n        }\n        let [width, height, color] = args;\n        width = Sk.ffi.remapToJs(width)\n        height = Sk.ffi.remapToJs(height)\n        graph.lineStyle(self.size, transColor(Sk.ffi.remapToJs(color)), 1);\n        graph.drawRect(transX(left), transY(top), width, height);\n        app.stage.addChild(graph);\n      }\n    })\n    $loc.filled_rect =  new Sk.builtin.func(function(self, ...args) {\n      if (Sk.abstr.typeName(args[0]) === \"Rect\") {\n        const [rect, color] = args;\n        graph.lineStyle(0);\n        graph.beginFill(transColor(Sk.ffi.remapToJs(color)), 1);\n        graph.drawRect(rect.pos.x, rect.pos.y, rect.size.width, rect.size.height);\n        graph.endFill();\n        app.stage.addChild(graph);\n      } else {\n        let left, top\n        const leftTop = Sk.ffi.remapToJs(args[0])\n        if (Array.isArray(leftTop)) {\n          left = leftTop[0]\n          top = leftTop[1]\n          args.shift();\n        } else {\n          left = args[0].v\n          top = args[1].v\n          args.shift();\n          args.shift();\n        }\n        let [width, height, color] = args;\n        width = Sk.ffi.remapToJs(width)\n        height = Sk.ffi.remapToJs(height)\n        color = transColor(Sk.ffi.remapToJs(color))\n        graph.lineStyle(0);\n        graph.beginFill(color, 1);\n        graph.drawRect(transX(left), transY(top), width, height);\n        graph.endFill();\n        app.stage.addChild(graph);\n      }\n    })\n    $loc.clear = new Sk.builtin.func(function(self) {\n      graph.clear()\n      self.basicText && self.basicText.destroy()\n    })\n    $loc.text = new Sk.builtin.func(genkwaFunc(function(args, kwa) {\n      // args = Sk.ffi.remapToJs(args);\n      kwa = Sk.ffi.remapToJs(kwa);\n      let [self, str, pos, color, fontsize, fontname] = args;\n      color = transColor(Sk.ffi.remapToJs(color || kwa.color));\n      fontsize = Sk.ffi.remapToJs(fontsize || kwa.fontsize);\n      fontname = Sk.ffi.remapToJs(fontname || kwa.fontname)\n      pos = transPos(Sk.ffi.remapToJs(pos))\n      const style = new PIXI.TextStyle({\n        fontFamily: fontname || 'PingFang SC',\n        fontSize: fontsize,\n        fill: color,\n      });\n      const basicText = new PIXI.Text(str.v, style);\n      self.basicText = basicText\n      basicText.anchor.set(0.5);\n      if (pos) {\n        basicText.x = pos[0];\n        basicText.y = pos[1];\n      }\n      app.stage.addChild(basicText);\n    }, true))\n  }, 'Draw', []);\n  // 屏幕类\n  \n  mod.screen = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.draw = Sk.misceval.callsimOrSuspend(mod.draw)\n    $loc.clear = new Sk.builtin.func(function(self) {\n      // app.destroy();\n      while(app.stage.children.length > 0){   var child = app.stage.getChildAt(0);  app.stage.removeChild(child);}\n    })\n    $loc.fill = new Sk.builtin.func(function(self, color) {\n      graph.clear()\n      graph.beginFill(transColor(Sk.ffi.remapToJs(color)), 1);\n      graph.drawRect(0, 0, app.view.width, app.view.height);\n      graph.endFill();\n      app.stage.addChild(graph);\n    })\n  }, 'Screen', []));\n  // 时间类\n  mod.clock = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.timerMap = new WeakMap();\n    })\n    $loc.schedule = new Sk.builtin.func(function(self, callback, delay) {\n      self.timerMap.set(callback, setTimeout(function() {\n        Sk.misceval.callsimAsync(null, callback)\n      }, delay.v * 1000))\n    })\n    $loc.schedule_interval = new Sk.builtin.func(function(self, callback, delay) {\n      self.timerMap.set(callback, setInterval(function() {\n        Sk.misceval.callsimAsync(null, callback)\n      }, delay.v * 1000))\n    })\n    $loc.schedule_unique = new Sk.builtin.func(function(self, callback, delay) {\n      if (self.timerMap.has(callback)) {\n        clearTimeout(self.timerMap.get(callback))\n        clearInterval(self.timerMap.get(callback))\n      }\n      self.timerMap.set(callback, setTimeout(function() {\n        Sk.misceval.callsimAsync(null, callback)\n      }, delay.v * 1000))\n    })\n    $loc.unschedule = new Sk.builtin.func(function(self, callback, delay) {\n      if (self.timerMap.has(callback)) {\n        clearTimeout(self.timerMap.get(callback))\n        clearInterval(self.timerMap.get(callback))\n      }\n    })\n\n  }, 'Clock', []));\n\n  // 音乐类\n  mod.music = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.audio = new Audio()\n    })\n    $loc.play = new Sk.builtin.func(function(self, name) {\n      self.audio.src = name.v || `./assets/${name.v}.mp3`;\n      self.audio.loop = true;\n      self.audio.play();\n    })\n    $loc.play_once = new Sk.builtin.func(function(self, name) {\n      self.audio.src = name.v || s`./assets/${name.v}.mp3`;\n      self.audio.loop = false;\n      self.audio.play();\n    })\n    $loc.is_playing = new Sk.builtin.func(function(self, name) {\n      return !self.audio.paused\n    })\n    $loc.volume = defineProperty(function(self) {\n      return self.audio.volume;\n    }, function(self, val){\n      self.audio.volume = val.v\n    })\n    $loc.set_volume = new Sk.builtin.func(function(self, val){\n      self.audio.volume = val.v\n    })\n    $loc.get_volume = new Sk.builtin.func(function(self) {\n      return self.audio.volume;\n    })\n    $loc.stop = new Sk.builtin.func(function(self, name) {\n      self.audio.currentTime = 0\n      self.audio.pause();\n    })\n  }, 'Music', []));\n\n  // 音效类\n  mod.sound = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.soundMap = {};\n    })\n    $loc.play = new Sk.builtin.func(function(self, name) {\n      if(self.soundMap[name.v]) {\n        self.soundMap[name.v].play()\n        self.soundMap[name.v].currentTime = 0\n      } else {\n        const audio = new Audio()\n        audio.src = name.v;\n        audio.loop = false;\n        audio.play();\n        self.soundMap[name.v] = audio\n      }\n    })\n    $loc.stop = new Sk.builtin.func(function(self, name) {\n      self.soundMap[name.v].pause();\n    })\n  }, 'Sound', []));\n\n  // 动画类\n  mod.animate = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    let charm;\n    $loc.__init__ =  new Sk.builtin.func(genkwaFunc(function(args, kwa) {\n      kwa = Sk.ffi.remapToJs(kwa);\n      let [self, actor, tween, duration, on_finished, targets] = args;\n      tween = tween || kwa.tween || 'linear';\n      duration = duration || kwa.duration || 1;\n      on_finished = on_finished || kwa.on_finished\n      const x = transX(kwa.x) || actor.sprite.x;\n      const y = transY(kwa.y) || actor.sprite.y;\n      const pos = transPos(targets) || transPos(kwa.pos) || [x, y];\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        loadScript('https://cdnjs.cloudflare.com/ajax/libs/tween.js/17.1.1/Tween.min.js', 'Charm').then(() => {\n          if (!charm) {\n            // charm = new TWEEN(PIXI);\n            app.ticker.add(() => {\n              // charm.update()\n              TWEEN.update();\n            })\n          }\n          const tweenMap = {\n            linear: TWEEN.Easing.linear, // 线性\n            accelerate: TWEEN.Easing.Quartic.Out, // 加速\n            decelerate: TWEEN.Easing.Quartic.In, // 减速\n            accel_decel: TWEEN.Easing.Quartic.InOut, // 先加速再加速\n            elastic_start: TWEEN.Easing.Elastic.In, // 开始时反弹\n            elastic_end: TWEEN.Easing.Elastic.Out, // 结束时反弹\n            elastic_start_end: TWEEN.Easing.Elastic.InOut, // 开始结束都反弹\n            bounce_start: TWEEN.Easing.Bounce.In, // 开始时弹跳\n            bounce_end: TWEEN.Easing.Bounce.Out, // 结束时弹跳\n            bounce_start_end: TWEEN.Easing.Bounce.InOut, // 开始和结束都弹跳\n          }\n          self.ani = new TWEEN.Tween({\n            x: actor.sprite.x,\n            y: actor.sprite.y,\n          }).to({\n            x: pos[0] || x,\n            y: pos[1] || y,\n          }, duration * 1000).easing(tweenMap[tween])\n          .onUpdate(function (object) {\n            actor.sprite.y = object.y;\n            actor.sprite.x = object.x;\n          }).start();\n          self.ani.onComplete = function() {\n            on_finished && Sk.misceval.callsim(on_finished)\n          }\n          // self.ani = charm.slide(actor.sprite, pos[0] || x, pos[1] || y, duration * 60, tweenMap[tween])\n          // self.ani.onComplete = function() {\n          //   on_finished && Sk.misceval.callsim(on_finished)\n          // }\n          resolve();\n        })\n    }));\n    }, true))\n    $loc.stop = new Sk.builtin.func(function(self) {\n      self.ani.pause();\n    })\n    $loc.running = defineGetter(function(self) {\n      return Sk.ffi.remapToPy(self.ani.tweens[0].playing);\n    })\n  }, 'Animate', [])\n\n  // 主循环\n  app.ticker.add((delta) => {\n    Sk.globals.draw && Sk.misceval.callsimAsync(null, Sk.globals.draw);\n    Sk.globals.update && Sk.misceval.callsimAsync(null, Sk.globals.update);\n  });\n\n  const keys = [\"K_0\", \"K_1\", \"K_2\", \"K_3\", \"K_4\", \"K_5\", \"K_6\", \"K_7\", \"K_8\", \"K_9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\", \"SHIFT\", \"CTRL\", \"ALT\", \"LEFT\", \"UP\", \"RIGHT\", \"DOWN\", \"PAGEUP\", \"PAGEDOWN\", \"END\", \"HOME\", \"ESCAPE\", \"ENTER\", \"SPACE\", \"RETURN\", \"BACKSPACE\", \"INSERT\", \"DELETE\", \"F1\", \"F2\", \"F3\", \"F4\", \"F5\", \"F6\", \"F7\", \"F8\", \"F9\", \"F10\", \"F11\", \"F12\", \"F13\", \"F14\", \"F15\"];\n  const nativeKeys = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'Shift', 'Ctrl', 'Alt', 'ArrowLeft', 'ArrowUp', 'ArrowRight', 'ArrowDown', 'PageUp', 'PageDown', 'End', 'Home', 'Escape', 'Enter', '', 'Return', 'Backspace', 'Insert', 'Delete', \"F1\", \"F2\", \"F3\", \"F4\", \"F5\", \"F6\", \"F7\", \"F8\", \"F9\", \"F10\", \"F11\", \"F12\", \"F13\", \"F14\", \"F15\"]\n  const keysMap = {}\n  nativeKeys.map((nativeKeys, index) => {\n    keysMap[nativeKeys] = keys[index]\n  })\n  const keyboard = {};\n  \n  // 键盘按下事件\n  window.addEventListener('keydown', function(e) {\n    keyboard[keysMap[e.key]] = true\n    Sk.globals.on_key_down && Sk.misceval.callsimAsync(null, Sk.globals.on_key_down, Sk.ffi.remapToPy(keysMap[e.key]));\n  })\n  window.addEventListener('keyup', function(e) {\n    keyboard[keysMap[e.key]] = false\n    Sk.globals.on_key_down && Sk.misceval.callsimAsync(null, Sk.globals.on_key_down, Sk.ffi.remapToPy(keysMap[e.key]));\n  })\n  // 键盘名称\n  mod.Keys = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    keys.map((key) => {\n      $loc[key] = defineGetter(() => Sk.ffi.remapToPy(key))\n    })\n  }, 'Keys', []));\n  // 键盘按下\n  mod.keyboard = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    keys.map((key, i) => {\n      $loc[key.toLowerCase()] = defineGetter(() => keyboard[key] || false)\n    })\n  }, 'keyboard', []));\n  \n  const mouseDownMap = {\n    '0': 'LEFT',\n    '1': 'MIDDLE',\n    '2': 'RIGHT',\n  }\n  let mousePos = {};\n  const mouse = {};\n  let buttons = [];\n  const insertData = function(arr, data) {\n    if (data && !~arr.indexOf(data)) {\n      arr.push(data)\n    }\n  }\n  const delData = function(arr, data) {\n    const index = arr.indexOf(data)\n    if (~index) {\n      arr.splice(index, 1)\n    }\n  }\n  // 鼠标按下事件\n  app.view.addEventListener('mousedown', function(e) {\n    const button = (mouseDownMap[e.button] || '').toLowerCase()\n    insertData(buttons, button)\n    Sk.globals.on_mouse_down && Sk.misceval.callsimAsync(null, Sk.globals.on_mouse_down, Sk.ffi.remapToPy([\n      transX(e.offsetX, true),\n      transY(e.offsetY, true),\n    ]), Sk.ffi.remapToPy(button));\n  })\n  // 鼠标抬起事件\n  app.view.addEventListener('mouseup', function(e) {\n    const button = (mouseDownMap[e.button] || '').toLowerCase()\n    delData(buttons, button)\n    Sk.globals.on_mouse_up && Sk.misceval.callsimAsync(null, Sk.globals.on_mouse_up, Sk.ffi.remapToPy([\n      transX(e.offsetX, true),\n      transY(e.offsetY, true),\n    ]), Sk.ffi.remapToPy(mouseDownMap[e.button]));\n  })\n  // 禁用鼠标右键\n  document.oncontextmenu = function(){\n    return false;\n  }\n  // 鼠标移动事件\n  app.view.addEventListener('mousemove', function(e) {\n    mousePos = {\n      x: transX(e.offsetX, true),\n      y: transY(e.offsetY, true),\n    }\n    Sk.globals.on_mouse_move && Sk.misceval.callsimAsync(\n      null,\n      Sk.globals.on_mouse_move,\n      Sk.ffi.remapToPy([mousePos.x, mousePos.y]),\n      Sk.ffi.remapToPy([mousePos.x, mousePos.y]),\n      Sk.ffi.remapToPy(buttons)\n      );\n  })\n  // 鼠标滚轮事件\n  app.view.addEventListener('wheel', function(e) {\n    if (e.deltaY > 0) {\n      insertData(buttons, 'wheel_down')\n      delData(buttons, 'wheel_up')\n    } else if (e.deltaY < 0) {\n      insertData(buttons, 'wheel_up')\n      delData(buttons, 'wheel_down')\n    } else {\n      delData(buttons, 'wheel_up')\n      delData(buttons, 'wheel_down')\n    }\n  })\n  \n  // 鼠标位置\n  mod.mouse = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.x = defineGetter(() => mousePos.x)\n    $loc.y = defineGetter(() => mousePos.y)\n    $loc.pos = defineGetter(() => Sk.ffi.remapToPy([mousePos.x, mousePos.y]))\n    $loc.LEFT = Sk.ffi.remapToPy('left')\n    $loc.MIDDLE =  Sk.ffi.remapToPy('middle')\n    $loc.RIGHT =  Sk.ffi.remapToPy('right')\n    $loc.WHEEL_UP =  Sk.ffi.remapToPy('wheel_up')\n    $loc.WHEEL_DOWN =  Sk.ffi.remapToPy('wheel_down')\n  }, 'Mouse', []));\n\n  mod.go =  new Sk.builtin.func(function(self) {\n  })\n\n  return mod;\n};"]}