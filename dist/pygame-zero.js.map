{"version":3,"sources":["utils.js","pygame-zero.js"],"names":["loadScript","src","varName","window","Promise","resolve","reject","el","document","createElement","onload","onerror","e","body","removeChild","async","console","log","appendChild","hitTestRectangle","r1","r2","Array","isArray","x","y","width","height","centerX","centerY","halfWidth","halfHeight","vx","vy","combinedHalfWidths","combinedHalfHeights","hit","Math","abs","JsonLoadedMap","textureRecources","resource","loadResource","list","PIXI","utils","TextureCache","loader","add","load","texture","resources","test","fetch","then","res","json","prefix","replace","resoureList","map","item","Sk","defineGetter","func","misceval","callsimOrSuspend","builtins","property","builtin","genkwaFunc","isJsArgs","kwaFunc","kwa","args","kwargs","dict","defineProperty","obj","self","ffi","remapToPy","val","v","ColorNameMap","aqua","black","blue","fuchsia","gray","green","lime","maroon","navy","olive","orange","purple","red","silver","teal","white","yellow","$builtinmodule","mod","__name__","str","isWebGLSupported","Application","Sprite","Graphics","Text","TextStyle","pre","next","crossOrigin","loadType","loaders","Resource","LOAD_TYPE","XHR","PGZApp","destroy","removeView","backgroundColor","app","round","view","transX","isReserve","transY","transPos","pos","transColor","color","rgb2hex","match","string2hex","PyGameZero","container","WIDTH","HEIGHT","Actor","buildClass","$gbl","$loc","__init__","actorName","promiseToSuspension","remapToJs","sprite","zOrder","anchor","set","stage","addChild","angle","show","image","frame","distance_to","sqrt","pow","angle_to","x1","x2","y1","y2","z","asin","PI","collide_point","collide_actor","actor","remove","Rect","size","graph","draw","fill","beginFill","line","start","end","lineStyle","moveTo","lineTo","circle","radius","drawCircle","filled_circle","endFill","rect","abstr","typeName","drawRect","left","top","leftTop","shift","filled_rect","clear","basicText","text","fontsize","fontname","style","fontFamily","fontSize","screen","renderer","clock","timerMap","WeakMap","schedule","callback","delay","setTimeout","callsimAsync","schedule_interval","setInterval","schedule_unique","has","clearTimeout","get","clearInterval","unschedule","music","audio","Audio","play","name","loop","play_once","s","is_playing","paused","volume","set_volume","get_volume","stop","currentTime","pause","sound","soundMap","animate","tween","duration","on_finished","targets","ticker","TWEEN","update","tweenMap","linear","Easing","accelerate","Quartic","Out","decelerate","In","accel_decel","InOut","elastic_start","Elastic","elastic_end","elastic_start_end","bounce_start","Bounce","bounce_end","bounce_start_end","ani","Tween","to","easing","onUpdate","object","onComplete","callsim","running","tweens","playing","delta","globals","keys","keysMap","nativeKeys","index","keyboard","addEventListener","key","on_key_down","Keys","i","toLowerCase","mouseDownMap","mousePos","mouse","button","on_mouse_down","offsetX","offsetY","on_mouse_up","oncontextmenu","on_mouse_move","deltaY","LEFT","MIDDLE","RIGHT","WHEEL_UP","WHEEL_DOWN"],"mappings":"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","file":"pygame-zero.js","sourceRoot":"../pygame-zero","sourcesContent":["export function loadScript(src, varName){\n  if (window[varName]) {\n    return Promise.resolve(window[varName]);\n  }\n  const res = new Promise(function(resolve, reject) {\n    const el = document.createElement('script');\n    el.onload = function() {\n      resolve(varName && window.varName);\n    };\n\n    el.onerror = function(e) {\n      el.onload = null;\n      el.onerror = null;\n      document.body.removeChild(el);\n      reject(e);\n    };\n    el.src = src;\n    el.async = true;\n    console.log(document.body)\n    document.body.appendChild(el);\n  });\n  return res;\n}\n\n\n// 碰撞检测函数\nexport function hitTestRectangle(r1, r2) {\n  // 如果r2是坐标点\n  if (Array.isArray(r2)) {\n    r2.x = r2[0];\n    r2.y = r2[1];\n    r2.width = 0;\n    r2.height = 0;\n  }\n\n  //Define the variables we'll need to calculate\n  let hit;\n\n  //hit will determine whether there's a collision\n  hit = false;\n\n  //Find the center points of each sprite\n  r1.centerX = r1.x + r1.width / 2;\n  r1.centerY = r1.y + r1.height / 2;\n  r2.centerX = r2.x + r2.width / 2;\n  r2.centerY = r2.y + r2.height / 2;\n\n  //Find the half-widths and half-heights of each sprite\n  r1.halfWidth = r1.width / 2;\n  r1.halfHeight = r1.height / 2;\n  r2.halfWidth = r2.width / 2;\n  r2.halfHeight = r2.height / 2;\n\n  //Calculate the distance vector between the sprites\n  const vx = r1.centerX - r2.centerX;\n  const vy = r1.centerY - r2.centerY;\n\n  //Figure out the combined half-widths and half-heights\n  const combinedHalfWidths = r1.halfWidth + r2.halfWidth;\n  const combinedHalfHeights = r1.halfHeight + r2.halfHeight;\n\n  //Check for a collision on the x axis\n  if (Math.abs(vx) < combinedHalfWidths) {\n\n    //A collision might be occuring. Check for a collision on the y axis\n    if (Math.abs(vy) < combinedHalfHeights) {\n\n      //There's definitely a collision happening\n      hit = true;\n    } else {\n\n      //There's no collision on the y axis\n      hit = false;\n    }\n  } else {\n\n    //There's no collision on the x axis\n    hit = false;\n  }\n\n  //`hit` will be either `true` or `false`\n  return hit;\n}\n\n// 加载纹理\nconst JsonLoadedMap = {};\nexport function textureRecources (resource) {\n  function loadResource(resource) {\n    let list;\n    if (Array.isArray(resource)) {\n      list = [...resource];\n      resource = list[0]\n    }\n    return new Promise((resolve, reject) => {\n      if (window.PIXI.utils.TextureCache[resource]) {\n        resolve(window.PIXI.utils.TextureCache[resource])\n      } else {\n        console.log(list || resource)\n        window.PIXI.loader.add(list || resource).load(function() {\n          const texture = window.PIXI.loader.resources[resource].texture;\n          resolve(texture)\n        });\n      }\n    })\n  }\n  if (/\\.json$/.test(resource)) {\n    if (JsonLoadedMap[resource]) {\n      return loadResource(JsonLoadedMap[resource])\n    } else {\n      return fetch(resource).then((res) => {\n        return res.json()\n      }).then((res) => {\n        const prefix = resource.replace('index.json', '');\n        const resoureList = res.map((item) => {\n          return prefix + item\n        })\n        JsonLoadedMap[resource] = resoureList;\n        return loadResource(resoureList)\n      })\n    }\n  } else {\n    return loadResource(resource)\n  }\n}\nconst Sk = window.Sk;\n// getter函数\nexport const defineGetter = function(func) {\n  return Sk.misceval.callsimOrSuspend(Sk.builtins.property, new Sk.builtin.func(func), new Sk.builtin.func(function() {}));\n}\n// 生成kwargs函数\nexport function genkwaFunc(func, isJsArgs) {\n  const kwaFunc = function(kwa, ...args){\n    if (!isJsArgs) {\n      args = new Sk.builtins['tuple'](args); /*vararg*/\n    }\n    const kwargs = new Sk.builtin.dict(kwa);\n    return func(args, kwargs)\n  }\n  kwaFunc['co_kwargs'] = true;\n  return kwaFunc;\n}\n// 监听属性getter/setter\nexport const defineProperty = function(obj, property) {\n  return Sk.misceval.callsimOrSuspend(Sk.builtins.property, new Sk.builtin.func(function(self) {\n    if (typeof obj === 'function') {\n      return obj(self)\n    } else {\n      return Sk.ffi.remapToPy(self[obj][property])\n    }\n  }), new Sk.builtin.func(function(self, val) {\n    if (typeof property === 'function') {\n      property(self, val)\n    } else {\n      self[obj][property] = val.v;\n    }\n  }))\n}\n  \n\n","const Sk = window.Sk;\nconst PIXI = window.PIXI;\nimport {loadScript, textureRecources, defineGetter, defineProperty, hitTestRectangle, genkwaFunc} from './utils'\n// 17中标准颜色名对应的色值\nconst ColorNameMap = {\n  aqua: '#00FFFF',\n  black: '#000000',\n  blue: '#0000FF',\n  fuchsia: '#FF00FF',\n  gray: '#808080',\n  green: '#008000',\n  lime: '#00FF00',\n  maroon: '#800000',\n  navy: '#000080',\n  olive: '#808000',\n  orange: '#FFA500',\n  purple: '#800080',\n  red: '#FF0000',\n  silver: '#C0C0C0',\n  teal: '#008080',\n  white: '#FFFFFF',\n  yellow: '#FFFF00',\n}\n\nwindow.$builtinmodule = function() {\n  const mod = { __name__: new Sk.builtin.str(\"pygame-zero\") };\n  let type = \"WebGL\"\n  if(!PIXI.utils.isWebGLSupported()){\n    type = \"canvas\"\n  }\n\n  // PIXI.utils.sayHello(type)\n  //Aliases\n  const Application = PIXI.Application,\n    loader = PIXI.loader,\n    resources = PIXI.loader.resources,\n    utils = PIXI.utils,\n    Sprite = PIXI.Sprite,\n    Graphics = PIXI.Graphics,\n    Text = PIXI.Text,\n    TextStyle = PIXI.TextStyle;\n  window.PIXI.loader.pre((resource, next) => {\n    resource.crossOrigin = 'anonymous';\n    resource.loadType = window.PIXI.loaders.Resource.LOAD_TYPE.XHR;\n    next();\n  });\n  if (window.PGZApp) {\n    // document.getElementById('stage').removeChild(window.PGZApp.view);\n    window.PGZApp.destroy({\n      removeView: true\n    });\n    window.PGZApp = void 0;\n  }\n  window.PGZApp = new Application({\n    backgroundColor: 0x000000,\n    width: 500,\n    height: 400,\n  });\n  const app = window.PGZApp;\n \n  const halfWidth = Math.round(app.view.width/2);\n  const halfHeight = Math.round(app.view.height/2);\n  // 笛卡尔坐标系转换\n  function transX(x, isReserve) {\n    // if (isReserve) {\n    //   return x - halfWidth\n    // } else {\n    //   return x + halfWidth\n    // }\n    return x;\n  }\n  // 笛卡尔坐标系转换\n  function transY(y, isReserve) {\n    // if (isReserve) {\n    //   if (y > halfHeight) {\n    //     return (y - halfHeight) * -1;\n    //   } else {\n    //     return halfHeight - y;\n    //   }\n    // } else {\n    //   if (y > 0) {\n    //     return halfHeight - y;\n    //   } else {\n    //     return halfHeight + (y * -1);\n    //   }\n    // }\n    return y;\n  }\n  function transPos(pos, isReserve){\n    if (!pos) {\n      return pos\n    }\n    return [transX(pos[0], isReserve), transY(pos[1], isReserve)]\n  }\n  // 字符串色值转十六进制数字\n  function transColor(color) {\n    if (Array.isArray(color)) {\n      return utils.rgb2hex(color);\n    } else {\n      if (color.match('#')) {\n        return utils.string2hex(color);\n      } else {\n        if (ColorNameMap[color]) {\n          return utils.string2hex(ColorNameMap[color]);\n        } else {\n          return 0xffffff;\n        }\n      }\n    }\n  }\n\n  window.PyGameZero.container.appendChild(app.view);\n  \n  mod.WIDTH = Sk.ffi.remapToPy(app.view.width);\n  mod.HEIGHT = Sk.ffi.remapToPy(app.view.height);\n\n  // 角色类\n  mod.Actor = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    // $loc.__init__就是构造器\n    $loc.__init__ = new Sk.builtin.func(function(self, actorName) {\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        actorName = Sk.ffi.remapToJs(actorName);\n        textureRecources(actorName || `./assets/${actorName.v}/index.json`).then(function(texture) {\n          const sprite = new Sprite(texture)\n          sprite.zOrder=1\n          self.sprite = sprite;\n          self.sprite.anchor.set(0.5);\n          self.sprite.x = transX(0)\n          self.sprite.y = transY(0)\n          self.actorName = actorName;\n          app.stage.addChild(sprite);\n          resolve()\n        })\n      }));\n    });\n    $loc.x = defineProperty(function(self){\n      return Sk.ffi.remapToPy(transX(self.sprite.x, true))\n    }, function(self, val){\n      self.sprite.x = transX(val.v)\n    })\n    $loc.y = defineProperty(function(self){\n      return Sk.ffi.remapToPy(transY(self.sprite.y, true))\n    }, function(self, val){\n      self.sprite.y = transY(val.v)\n    })\n    $loc.width = defineProperty('sprite', 'width')\n    $loc.height = defineProperty('sprite', 'height')\n    $loc.pos = defineProperty(function(self) {\n      return Sk.ffi.remapToPy(transPos([self.sprite.x, self.sprite.y], true))\n    }, function (self, val) {\n      const pos = transPos(Sk.ffi.remapToJs(val))\n      self.sprite.x = pos[0];\n      self.sprite.y = pos[1];\n      self['sprite']['pos'] = [pos[0], pos[1]];\n    })\n    $loc.angle = defineProperty('sprite', 'angle')\n    $loc.show  = defineProperty('sprite', 'visible')\n    $loc.image = defineProperty(function(self) {\n      return Sk.ffi.remapToPy(self['sprite']['texture'])\n    }, function (self, val) {\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        textureRecources(val.v).then(function(texture) {\n          self['sprite']['texture'] = texture;\n          resolve()\n        })\n      }))\n    })\n    $loc.frame = defineProperty(function(self) {\n      return Sk.ffi.remapToPy(self['sprite']['texture'])\n      }, function (self, val) {\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        textureRecources(self.actorName[val.v-1] || `./assets/${self.actorName}/造型${val.v}.png`).then(function(texture) {\n          self['sprite']['texture'] = texture;\n          resolve()\n        })\n      }))\n    })\n    $loc.distance_to = new Sk.builtin.func(function(self, pos) {\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      // 计算两点距离：|AB| = √((x1-x2)²+(y1-y2)²)\n      return Sk.ffi.remapToPy(Math.round(Math.abs(Math.sqrt(Math.pow(self.sprite.x - pos[0], 2) + Math.pow(self.sprite.y - pos[1], 2)))))\n    })\n    $loc.angle_to = new Sk.builtin.func(function(self, pos) {\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      // 计算两点角度：arcsin(|y1-y2| ÷ √((x1-x2)²+(y1-y2)²)) ÷ π ×180\n      const x1 = self.sprite.y;\n      const x2 = pos[0];\n      const y1 = self.sprite.y;\n      const y2 = pos[1];\n      const x = Math.abs(x1-x2);\n      const y = Math.abs(y1-y2);\n      const z = Math.sqrt(x*x+y*y);\n      return Sk.ffi.remapToPy(Math.round(Math.asin(y/z)/Math.PI*180))\n    })\n    $loc.collide_point = new Sk.builtin.func(function(self, pos) {\n      return hitTestRectangle(self.sprite, transPos(Sk.ffi.remapToJs(pos)))\n    })\n    $loc.collide_actor = new Sk.builtin.func(function(self, actor) {\n      return hitTestRectangle(self.sprite, actor.sprite)\n    })\n    $loc.remove = new Sk.builtin.func(function(self) {\n      app.stage.removeChild(self.sprite);\n    })\n  }, 'Actor')\n\n  // 矩形类\n  mod.Rect = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    // $loc.__init__就是构造器\n    let _self;\n    $loc.__init__ = new Sk.builtin.func(function(self, pos, size) {\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      size = Sk.ffi.remapToJs(size);\n      self.pos = {\n        x: pos[0],\n        y: pos[1],\n      }\n      self.size = {\n        width: size[0],\n        height: size[1],\n      }\n    });\n    $loc.pos = defineGetter((self) => Sk.ffi.remapToPy(transPos(self.pos, true)))\n    $loc.size = defineGetter((self) => Sk.ffi.remapToPy(self.size))\n  }, 'Rect', [])\n  // 画笔类\n  const graph = new Graphics();\n  mod.draw = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.size = 5;\n    })\n    $loc.size = new Sk.builtin.func(function(self, size) {\n      self.size = size.v;\n    })\n    $loc.fill = new Sk.builtin.func(function(self, color) {\n      color = transColor(Sk.ffi.remapToJs(color));\n      graph.beginFill(color)\n    })\n    $loc.line =  new Sk.builtin.func(function(self, start, end, color) {\n      color = transColor(Sk.ffi.remapToJs(color));\n      start = Sk.ffi.remapToJs(start);\n      end = Sk.ffi.remapToJs(end);\n      graph.lineStyle(self.size || 2, color, 1);\n      graph.moveTo(start[0], start[1]);\n      graph.lineTo(end[0], end[1]);\n      app.stage.addChild(graph);\n    })\n    $loc.circle =  new Sk.builtin.func(function(self, pos, radius, color) {\n      color = transColor(Sk.ffi.remapToJs(color));\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      graph.lineStyle(self.size, color, 1);\n      graph.drawCircle(pos[0], pos[1], radius.v);\n      app.stage.addChild(graph);\n    })\n    $loc.filled_circle =  new Sk.builtin.func(function(self, pos, radius, color) {\n      color = transColor(Sk.ffi.remapToJs(color));\n      pos = transPos(Sk.ffi.remapToJs(pos));\n      graph.lineStyle(0);\n      graph.beginFill(color, 1);\n      graph.drawCircle(pos[0], pos[1], radius.v);\n      graph.endFill();\n      app.stage.addChild(graph);\n    })\n    $loc.rect =  new Sk.builtin.func(function(self, ...args) {\n      if (Sk.abstr.typeName(args[0]) === \"Rect\") {\n        const [rect, color] = args;\n        graph.lineStyle(self.size, transColor(Sk.ffi.remapToJs(color)), 1);\n        graph.drawRect(rect.pos.x, rect.pos.y, rect.size.width, rect.size.height);\n        app.stage.addChild(graph);\n      } else {\n        let left, top\n        const leftTop = Sk.ffi.remapToJs(args[0])\n        if (Array.isArray(leftTop)) {\n          left = leftTop[0]\n          top = leftTop[1]\n          args.shift();\n        } else {\n          left = args[0].v\n          top = args[1].v\n          args.shift();\n          args.shift();\n        }\n        let [width, height, color] = args;\n        width = Sk.ffi.remapToJs(width)\n        height = Sk.ffi.remapToJs(height)\n        graph.lineStyle(self.size, transColor(Sk.ffi.remapToJs(color)), 1);\n        graph.drawRect(transX(left), transY(top), width, height);\n        app.stage.addChild(graph);\n      }\n    })\n    $loc.filled_rect =  new Sk.builtin.func(function(self, ...args) {\n      if (Sk.abstr.typeName(args[0]) === \"Rect\") {\n        const [rect, color] = args;\n        graph.lineStyle(0);\n        graph.beginFill(transColor(Sk.ffi.remapToJs(color)), 1);\n        graph.drawRect(rect.pos.x, rect.pos.y, rect.size.width, rect.size.height);\n        graph.endFill();\n        app.stage.addChild(graph);\n      } else {\n        let left, top\n        const leftTop = Sk.ffi.remapToJs(args[0])\n        if (Array.isArray(leftTop)) {\n          left = leftTop[0]\n          top = leftTop[1]\n          args.shift();\n        } else {\n          left = args[0].v\n          top = args[1].v\n          args.shift();\n          args.shift();\n        }\n        let [width, height, color] = args;\n        width = Sk.ffi.remapToJs(width)\n        height = Sk.ffi.remapToJs(height)\n        color = transColor(Sk.ffi.remapToJs(color))\n        graph.lineStyle(0);\n        graph.beginFill(color, 1);\n        graph.drawRect(transX(left), transY(top), width, height);\n        graph.endFill();\n        app.stage.addChild(graph);\n      }\n    })\n    $loc.clear = new Sk.builtin.func(function(self) {\n      graph.clear()\n      self.basicText && self.basicText.destroy()\n    })\n    $loc.text = new Sk.builtin.func(genkwaFunc(function(args, kwa) {\n      // args = Sk.ffi.remapToJs(args);\n      kwa = Sk.ffi.remapToJs(kwa);\n      let [self, str, pos, color, fontsize, fontname] = args;\n      color = transColor(Sk.ffi.remapToJs(color || kwa.color));\n      fontsize = Sk.ffi.remapToJs(fontsize || kwa.fontsize);\n      fontname = Sk.ffi.remapToJs(fontname || kwa.fontname)\n      pos = transPos(Sk.ffi.remapToJs(pos))\n      const style = new PIXI.TextStyle({\n        fontFamily: fontname || 'PingFang SC',\n        fontSize: fontsize,\n        fill: color,\n      });\n      const basicText = new PIXI.Text(str.v, style);\n      self.basicText = basicText\n      basicText.anchor.set(0.5);\n      if (pos) {\n        basicText.x = pos[0];\n        basicText.y = pos[1];\n      }\n      app.stage.addChild(basicText);\n    }, true))\n  }, 'Draw', []);\n  // 屏幕类\n  mod.screen = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.draw = Sk.misceval.callsimOrSuspend(mod.draw)\n    $loc.clear = new Sk.builtin.func(function(self) {\n      app.destroy();\n    })\n    $loc.fill = new Sk.builtin.func(function(self, color) {\n      app.renderer.backgroundColor = transColor(color.v);\n    })\n  }, 'Screen', []));\n  // 时间类\n  mod.clock = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.timerMap = new WeakMap();\n    })\n    $loc.schedule = new Sk.builtin.func(function(self, callback, delay) {\n      self.timerMap.set(callback, setTimeout(function() {\n        Sk.misceval.callsimAsync(null, callback)\n      }, delay.v * 1000))\n    })\n    $loc.schedule_interval = new Sk.builtin.func(function(self, callback, delay) {\n      self.timerMap.set(callback, setInterval(function() {\n        Sk.misceval.callsimAsync(null, callback)\n      }, delay.v * 1000))\n    })\n    $loc.schedule_unique = new Sk.builtin.func(function(self, callback, delay) {\n      if (self.timerMap.has(callback)) {\n        clearTimeout(self.timerMap.get(callback))\n        clearInterval(self.timerMap.get(callback))\n      }\n      self.timerMap.set(callback, setTimeout(function() {\n        Sk.misceval.callsimAsync(null, callback)\n      }, delay.v * 1000))\n    })\n    $loc.unschedule = new Sk.builtin.func(function(self, callback, delay) {\n      if (self.timerMap.has(callback)) {\n        clearTimeout(self.timerMap.get(callback))\n        clearInterval(self.timerMap.get(callback))\n      }\n    })\n\n  }, 'Clock', []));\n\n  // 音乐类\n  mod.music = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.audio = new Audio()\n    })\n    $loc.play = new Sk.builtin.func(function(self, name) {\n      self.audio.src = name.v || `./assets/${name.v}.mp3`;\n      self.audio.loop = true;\n      self.audio.play();\n    })\n    $loc.play_once = new Sk.builtin.func(function(self, name) {\n      self.audio.src = name.v || s`./assets/${name.v}.mp3`;\n      self.audio.loop = false;\n      self.audio.play();\n    })\n    $loc.is_playing = new Sk.builtin.func(function(self, name) {\n      return !self.audio.paused\n    })\n    $loc.volume = defineProperty(function(self) {\n      return self.audio.volume;\n    }, function(self, val){\n      self.audio.volume = val.v\n    })\n    $loc.set_volume = new Sk.builtin.func(function(self, val){\n      self.audio.volume = val.v\n    })\n    $loc.get_volume = new Sk.builtin.func(function(self) {\n      return self.audio.volume;\n    })\n    $loc.stop = new Sk.builtin.func(function(self, name) {\n      self.audio.currentTime = 0\n      self.audio.pause();\n    })\n  }, 'Music', []));\n\n  // 音效类\n  mod.sound = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.__init__ = new Sk.builtin.func(function(self) {\n      self.soundMap = {};\n    })\n    $loc.play = new Sk.builtin.func(function(self, name) {\n      if(self.soundMap[name.v]) {\n        self.soundMap[name.v].play()\n        self.soundMap[name.v].currentTime = 0\n      } else {\n        const audio = new Audio()\n        audio.src = name.v;\n        audio.loop = false;\n        audio.play();\n        self.soundMap[name.v] = audio\n      }\n    })\n    $loc.stop = new Sk.builtin.func(function(self, name) {\n      self.soundMap[name.v].pause();\n    })\n  }, 'Sound', []));\n\n  // 动画类\n  mod.animate = Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    let charm;\n    $loc.__init__ =  new Sk.builtin.func(genkwaFunc(function(args, kwa) {\n      kwa = Sk.ffi.remapToJs(kwa);\n      let [self, actor, tween, duration, on_finished, targets] = args;\n      tween = tween || kwa.tween || 'linear';\n      duration = duration || kwa.duration || 1;\n      on_finished = on_finished || kwa.on_finished\n      const x = transX(kwa.x) || actor.sprite.x;\n      const y = transY(kwa.y) || actor.sprite.y;\n      const pos = transPos(targets) || transPos(kwa.pos) || [x, y];\n      return new Sk.misceval.promiseToSuspension(new Promise(function(resolve) {\n        loadScript('https://cdnjs.cloudflare.com/ajax/libs/tween.js/17.1.1/Tween.min.js', 'Charm').then(() => {\n          if (!charm) {\n            // charm = new TWEEN(PIXI);\n            app.ticker.add(() => {\n              // charm.update()\n              TWEEN.update();\n            })\n          }\n          const tweenMap = {\n            linear: TWEEN.Easing.linear, // 线性\n            accelerate: TWEEN.Easing.Quartic.Out, // 加速\n            decelerate: TWEEN.Easing.Quartic.In, // 减速\n            accel_decel: TWEEN.Easing.Quartic.InOut, // 先加速再加速\n            elastic_start: TWEEN.Easing.Elastic.In, // 开始时反弹\n            elastic_end: TWEEN.Easing.Elastic.Out, // 结束时反弹\n            elastic_start_end: TWEEN.Easing.Elastic.InOut, // 开始结束都反弹\n            bounce_start: TWEEN.Easing.Bounce.In, // 开始时弹跳\n            bounce_end: TWEEN.Easing.Bounce.Out, // 结束时弹跳\n            bounce_start_end: TWEEN.Easing.Bounce.InOut, // 开始和结束都弹跳\n          }\n          self.ani = new TWEEN.Tween({\n            x: actor.sprite.x,\n            y: actor.sprite.y,\n          }).to({\n            x: pos[0] || x,\n            y: pos[1] || y,\n          }, duration * 1000).easing(tweenMap[tween])\n          .onUpdate(function (object) {\n            actor.sprite.y = object.y;\n            actor.sprite.x = object.x;\n          }).start();\n          self.ani.onComplete = function() {\n            on_finished && Sk.misceval.callsim(on_finished)\n          }\n          // self.ani = charm.slide(actor.sprite, pos[0] || x, pos[1] || y, duration * 60, tweenMap[tween])\n          // self.ani.onComplete = function() {\n          //   on_finished && Sk.misceval.callsim(on_finished)\n          // }\n          resolve();\n        })\n    }));\n    }, true))\n    $loc.stop = new Sk.builtin.func(function(self) {\n      self.ani.pause();\n    })\n    $loc.running = defineGetter(function(self) {\n      return Sk.ffi.remapToPy(self.ani.tweens[0].playing);\n    })\n  }, 'Animate', [])\n\n  // 主循环\n  app.ticker.add((delta) => {\n    Sk.globals.update && Sk.misceval.callsimAsync(null, Sk.globals.update);\n  });\n\n  const keys = [\"K_0\", \"K_1\", \"K_2\", \"K_3\", \"K_4\", \"K_5\", \"K_6\", \"K_7\", \"K_8\", \"K_9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\", \"SHIFT\", \"CTRL\", \"ALT\", \"LEFT\", \"UP\", \"RIGHT\", \"DOWN\", \"PAGEUP\", \"PAGEDOWN\", \"END\", \"HOME\", \"ESCAPE\", \"ENTER\", \"SPACE\", \"RETURN\", \"BACKSPACE\", \"INSERT\", \"DELETE\", \"F1\", \"F2\", \"F3\", \"F4\", \"F5\", \"F6\", \"F7\", \"F8\", \"F9\", \"F10\", \"F11\", \"F12\", \"F13\", \"F14\", \"F15\"];\n  const nativeKeys = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'Shift', 'Ctrl', 'Alt', 'ArrowLeft', 'ArrowUp', 'ArrowRight', 'ArrowDown', 'PageUp', 'PageDown', 'End', 'Home', 'Escape', 'Enter', '', 'Return', 'Backspace', 'Insert', 'Delete', \"F1\", \"F2\", \"F3\", \"F4\", \"F5\", \"F6\", \"F7\", \"F8\", \"F9\", \"F10\", \"F11\", \"F12\", \"F13\", \"F14\", \"F15\"]\n  const keysMap = {}\n  nativeKeys.map((nativeKeys, index) => {\n    keysMap[nativeKeys] = keys[index]\n  })\n  const keyboard = {};\n  \n  // 键盘按下事件\n  window.addEventListener('keydown', function(e) {\n    keyboard[keysMap[e.key]] = true\n    Sk.globals.on_key_down && Sk.misceval.callsimAsync(null, Sk.globals.on_key_down, Sk.ffi.remapToPy(keysMap[e.key]));\n  })\n  window.addEventListener('keyup', function(e) {\n    keyboard[keysMap[e.key]] = false\n    Sk.globals.on_key_down && Sk.misceval.callsimAsync(null, Sk.globals.on_key_down, Sk.ffi.remapToPy(keysMap[e.key]));\n  })\n  // 键盘名称\n  mod.Keys = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    keys.map((key) => {\n      $loc[key] = defineGetter(() => Sk.ffi.remapToPy(key))\n    })\n  }, 'Keys', []));\n  // 键盘按下\n  mod.keyboard = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    keys.map((key, i) => {\n      $loc[key.toLowerCase()] = defineGetter(() => keyboard[key] || false)\n    })\n  }, 'keyboard', []));\n  \n  const mouseDownMap = {\n    '0': 'LEFT',\n    '1': 'MIDDLE',\n    '2': 'RIGHT',\n  }\n  let mousePos = {};\n  const mouse = {};\n  // 鼠标按下事件\n  app.view.addEventListener('mousedown', function(e) {\n    mouse[mouseDownMap[e.button]] = true\n    Sk.globals.on_mouse_down && Sk.misceval.callsimAsync(null, Sk.globals.on_mouse_down, Sk.ffi.remapToPy([\n      transX(e.offsetX, true),\n      transY(e.offsetY, true),\n    ]), Sk.ffi.remapToPy(mouseDownMap[e.button]));\n  })\n  // 鼠标抬起事件\n  app.view.addEventListener('mouseup', function(e) {\n    mouse[mouseDownMap[e.button]] = false\n    Sk.globals.on_mouse_up && Sk.misceval.callsimAsync(null, Sk.globals.on_mouse_up, Sk.ffi.remapToPy([\n      transX(e.offsetX, true),\n      transY(e.offsetY, true),\n    ]), Sk.ffi.remapToPy(mouseDownMap[e.button]));\n  })\n  // 禁用鼠标右键\n  document.oncontextmenu = function(){\n    return false;\n  }\n  // 鼠标移动事件\n  app.view.addEventListener('mousemove', function(e) {\n    mousePos = {\n      x: transX(e.offsetX, true),\n      y: transY(e.offsetY, true),\n    }\n    Sk.globals.on_mouse_move && Sk.misceval.callsimAsync(null, Sk.globals.on_mouse_move, Sk.ffi.remapToPy([mousePos.x, mousePos.y])), Sk.ffi.remapToPy(mouseDownMap[e.button]);\n  })\n  // 鼠标滚轮事件\n  app.view.addEventListener('wheel', function(e) {\n    if (e.deltaY > 0) {\n      mouse['WHEEL_DOWN'] = true;\n      mouse['WHEEL_UP'] = false;\n    } else if (e.deltaY < 0) {\n      mouse['WHEEL_UP'] = true;\n      mouse['WHEEL_DOWN'] = false;\n    } else {\n      mouse['WHEEL_UP'] = false;\n      mouse['WHEEL_DOWN'] = false;\n    }\n  })\n  \n  // 鼠标位置\n  mod.mouse = Sk.misceval.callsimOrSuspend(Sk.misceval.buildClass(mod, function($gbl, $loc) {\n    $loc.x = defineGetter(() => mousePos.x)\n    $loc.y = defineGetter(() => mousePos.y)\n    $loc.pos = defineGetter(() => Sk.ffi.remapToPy([mousePos.x, mousePos.y]))\n    $loc.LEFT = defineGetter(() => mouse.LEFT || false)\n    $loc.MIDDLE = defineGetter(() => mouse.MIDDLE || false)\n    $loc.RIGHT = defineGetter(() => mouse.RIGHT || false)\n    $loc.WHEEL_UP = defineGetter(() => mouse.WHEEL_UP || false)\n    $loc.WHEEL_DOWN = defineGetter(() => mouse.WHEEL_DOWN || false)\n  }, 'Mouse', []));\n\n  return mod;\n};"]}